"0","### LETS TRY SAME TECHNIQUE BUT WITH LOGISTIC MODEL"
"0","#glm model"
"0","glm2 <- glm(Choice ~ . -Observation -Last_purchase -First_purchase - P_Youth - P_Child - P_Cook "
"0","            -P_DIY-P_Art"
"0","            , data = train, family = binomial) #Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred"
"0","summary(glm2)"
"1","
Call:
"
"1",""
"1","glm(formula = Choice ~ . - Observation - Last_purchase - First_purchase - 
    P_Youth - P_Child - P_Cook - P_DIY - P_Art, family = binomial, 
    data = train)"
"1",""
"1","
"
"1","
Coefficients:
"
"1","                        "
"1","   Estimate"
"1"," Std. Error"
"1"," z value"
"1"," Pr(>|z|)"
"1","    "
"1","
(Intercept)             "
"1","  0.7257579"
"1","  1.0584204"
"1","   0.686"
"1"," 0.492903"
"1","    "
"1","
Gender                  "
"1"," -0.8080987"
"1","  0.1369036"
"1","  -5.903"
"1"," 3.58e-09"
"1"," ***"
"1","
Amount_purchased        "
"1","  0.0020235"
"1","  0.0007874"
"1","   2.570"
"1"," 0.010175"
"1"," *  "
"1","
Frequency               "
"1"," -0.0949902"
"1","  0.0162271"
"1","  -5.854"
"1"," 4.80e-09"
"1"," ***"
"1","
Fst_purch_bckt0-12 Mths "
"1"," -0.2836819"
"1","  0.4603914"
"1","  -0.616"
"1"," 0.537779"
"1","    "
"1","
Fst_purch_bckt13-18 Mths"
"1"," -0.3352546"
"1","  0.3807153"
"1","  -0.881"
"1"," 0.378539"
"1","    "
"1","
Fst_purch_bckt19-30 Mths"
"1"," -0.2633678"
"1","  0.2960508"
"1","  -0.890"
"1"," 0.373679"
"1","    "
"1","
lst_purch_bckt1 Mths    "
"1"," -1.7889308"
"1","  0.4811910"
"1","  -3.718"
"1"," 0.000201"
"1"," ***"
"1","
lst_purch_bckt2 Mths    "
"1"," -1.3915651"
"1","  0.4079933"
"1","  -3.411"
"1"," 0.000648"
"1"," ***"
"1","
lst_purch_bckt3-4 Mths  "
"1"," -1.0104201"
"1","  0.3593715"
"1","  -2.812"
"1"," 0.004929"
"1"," ** "
"1","
P_Child_bck0            "
"1","  1.7049449"
"1","  0.3713523"
"1","   4.591"
"1"," 4.41e-06"
"1"," ***"
"1","
P_Child_bck1            "
"1","  1.1049567"
"1","  0.3447625"
"1","   3.205"
"1"," 0.001351"
"1"," ** "
"1","
P_Child_bck2            "
"1","  0.6618793"
"1","  0.3589813"
"1","   1.844"
"1"," 0.065216"
"1"," .  "
"1","
P_Youth_bck0            "
"1","  0.1031646"
"1","  0.6433241"
"1","   0.160"
"1"," 0.872596"
"1","    "
"1","
P_Youth_bck1            "
"1"," -0.5373134"
"1","  0.6433072"
"1","  -0.835"
"1"," 0.403585"
"1","    "
"1","
P_Youth_bck2            "
"1"," -0.3873643"
"1","  0.6941461"
"1","  -0.558"
"1"," 0.576814"
"1","    "
"1","
P_Cook_bck0             "
"1","  1.9342166"
"1","  0.3554885"
"1","   5.441"
"1"," 5.30e-08"
"1"," ***"
"1","
P_Cook_bck1             "
"1","  1.3415311"
"1","  0.3327153"
"1","   4.032"
"1"," 5.53e-05"
"1"," ***"
"1","
P_Cook_bck2             "
"1","  0.7182013"
"1","  0.3569998"
"1","   2.012"
"1"," 0.044244"
"1"," *  "
"1","
P_DIY_bck0              "
"1","  1.1824297"
"1","  0.5065374"
"1","   2.334"
"1"," 0.019578"
"1"," *  "
"1","
P_DIY_bck1              "
"1","  0.5239652"
"1","  0.5042507"
"1","   1.039"
"1"," 0.298760"
"1","    "
"1","
P_DIY_bck2              "
"1"," -0.0646927"
"1","  0.5709526"
"1","  -0.113"
"1"," 0.909787"
"1","    "
"1","
P_Art_bck0              "
"1"," -3.5153329"
"1","  0.5404615"
"1","  -6.504"
"1"," 7.80e-11"
"1"," ***"
"1","
P_Art_bck1              "
"1"," -2.6780814"
"1","  0.5355866"
"1","  -5.000"
"1"," 5.72e-07"
"1"," ***"
"1","
P_Art_bck2              "
"1"," -1.4660548"
"1","  0.5594343"
"1","  -2.621"
"1"," 0.008777"
"1"," ** "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
(Dispersion parameter for "
"1",""
"1","binomial"
"1",""
"1"," family taken to be "
"1",""
"1","1"
"1",""
"1",")

"
"1",""
"1","    Null deviance: 1799.5  on 1599  degrees of freedom
"
"1",""
"1","Residual deviance: 1413.3  on 1575  degrees of freedom
"
"1","AIC: "
"1",""
"1","1463.3"
"1",""
"1","

"
"1",""
"1","Number of Fisher Scoring iterations: "
"1",""
"1","5"
"1",""
"1","
"
"1","
"
"0","vif(glm2)"
"1","                "
"1","      GVIF"
"1"," Df"
"1"," GVIF^(1/(2*Df))"
"1","
Gender          "
"1","  1.029756"
"1","  1"
"1","        1.014769"
"1","
Amount_purchased"
"1","  1.226300"
"1","  1"
"1","        1.107384"
"1","
Frequency       "
"1","  2.445963"
"1","  1"
"1","        1.563957"
"1","
Fst_purch_bckt  "
"1","  9.454162"
"1","  3"
"1","        1.454132"
"1","
lst_purch_bckt  "
"1"," 10.300322"
"1","  3"
"1","        1.475056"
"1","
P_Child_bck     "
"1","  2.387797"
"1","  3"
"1","        1.156111"
"1","
P_Youth_bck     "
"1","  1.605685"
"1","  3"
"1","        1.082123"
"1","
P_Cook_bck      "
"1","  2.431688"
"1","  3"
"1","        1.159626"
"1","
P_DIY_bck       "
"1","  1.684408"
"1","  3"
"1","        1.090790"
"1","
P_Art_bck       "
"1","  1.891502"
"1","  3"
"1","        1.112076"
"1","
"
"0","#FINAL MODEL FOR TEST DATA - TO GET PREDICTIONS"
"0","glmf <- glm(Choice ~ . -Observation -Last_purchase -First_purchase - P_Youth - P_Child - P_Cook "
"0","            -P_DIY-P_Art"
"0","            , data = test, family = binomial) #Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred"
"0","summary(glmf)"
"1","
Call:
"
"1",""
"1","glm(formula = Choice ~ . - Observation - Last_purchase - First_purchase - 
    P_Youth - P_Child - P_Cook - P_DIY - P_Art, family = binomial, 
    data = test)"
"1",""
"1","
"
"1","
Coefficients:
"
"1","                        "
"1","  Estimate"
"1"," Std. Error"
"1"," z value"
"1"," Pr(>|z|)"
"1","   "
"1","
(Intercept)             "
"1"," -2.303846"
"1","   1.615457"
"1","  -1.426"
"1","  0.15383"
"1","   "
"1","
Gender                  "
"1"," -0.698891"
"1","   0.272130"
"1","  -2.568"
"1","  0.01022"
"1"," * "
"1","
Amount_purchased        "
"1","  0.001149"
"1","   0.001038"
"1","   1.107"
"1","  0.26836"
"1","   "
"1","
Frequency               "
"1"," -0.094073"
"1","   0.030540"
"1","  -3.080"
"1","  0.00207"
"1"," **"
"1","
PredProb                "
"1","  2.063437"
"1","   1.634876"
"1","   1.262"
"1","  0.20690"
"1","   "
"1","
Pred_Y                  "
"1","  0.003003"
"1","   0.292642"
"1","   0.010"
"1","  0.99181"
"1","   "
"1","
Fst_purch_bckt0-12 Mths "
"1"," -0.627524"
"1","   0.556704"
"1","  -1.127"
"1","  0.25965"
"1","   "
"1","
Fst_purch_bckt13-18 Mths"
"1"," -0.492758"
"1","   0.441295"
"1","  -1.117"
"1","  0.26416"
"1","   "
"1","
Fst_purch_bckt19-30 Mths"
"1"," -0.581644"
"1","   0.334432"
"1","  -1.739"
"1","  0.08200"
"1"," . "
"1","
lst_purch_bckt1 Mths    "
"1"," -0.582376"
"1","   0.597195"
"1","  -0.975"
"1","  0.32947"
"1","   "
"1","
lst_purch_bckt2 Mths    "
"1"," -0.550338"
"1","   0.500178"
"1","  -1.100"
"1","  0.27121"
"1","   "
"1","
lst_purch_bckt3-4 Mths  "
"1"," -0.074264"
"1","   0.418950"
"1","  -0.177"
"1","  0.85930"
"1","   "
"1","
P_Child_bck0            "
"1","  0.601389"
"1","   0.434996"
"1","   1.383"
"1","  0.16681"
"1","   "
"1","
P_Child_bck1            "
"1","  0.249501"
"1","   0.391506"
"1","   0.637"
"1","  0.52394"
"1","   "
"1","
P_Child_bck2            "
"1"," -0.498424"
"1","   0.436424"
"1","  -1.142"
"1","  0.25343"
"1","   "
"1","
P_Youth_bck0            "
"1","  0.485376"
"1","   0.847459"
"1","   0.573"
"1","  0.56682"
"1","   "
"1","
P_Youth_bck1            "
"1","  0.161126"
"1","   0.850021"
"1","   0.190"
"1","  0.84966"
"1","   "
"1","
P_Youth_bck2            "
"1","  0.301843"
"1","   0.897232"
"1","   0.336"
"1","  0.73656"
"1","   "
"1","
P_Cook_bck0             "
"1","  0.968840"
"1","   0.455540"
"1","   2.127"
"1","  0.03344"
"1"," * "
"1","
P_Cook_bck1             "
"1","  0.518889"
"1","   0.407789"
"1","   1.272"
"1","  0.20322"
"1","   "
"1","
P_Cook_bck2             "
"1","  0.509525"
"1","   0.409542"
"1","   1.244"
"1","  0.21345"
"1","   "
"1","
P_DIY_bck0              "
"1","  1.871201"
"1","   0.870243"
"1","   2.150"
"1","  0.03154"
"1"," * "
"1","
P_DIY_bck1              "
"1","  1.368124"
"1","   0.822078"
"1","   1.664"
"1","  0.09607"
"1"," . "
"1","
P_DIY_bck2              "
"1","  1.063974"
"1","   0.859324"
"1","   1.238"
"1","  0.21566"
"1","   "
"1","
P_Art_bck0              "
"1"," -1.866905"
"1","   1.190597"
"1","  -1.568"
"1","  0.11687"
"1","   "
"1","
P_Art_bck1              "
"1"," -0.807023"
"1","   0.932731"
"1","  -0.865"
"1","  0.38691"
"1","   "
"1","
P_Art_bck2              "
"1"," -0.478961"
"1","   0.713574"
"1","  -0.671"
"1","  0.50208"
"1","   "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
(Dispersion parameter for "
"1",""
"1","binomial"
"1",""
"1"," family taken to be "
"1",""
"1","1"
"1",""
"1",")

"
"1",""
"1","    Null deviance: 1377.7  on 2299  degrees of freedom
"
"1",""
"1","Residual deviance: 1113.8  on 2273  degrees of freedom
"
"1","AIC: "
"1",""
"1","1167.8"
"1",""
"1","

"
"1",""
"1","Number of Fisher Scoring iterations: "
"1",""
"1","6"
"1",""
"1","
"
"1","
"
"0","vif(glmf)"
"1","                "
"1","      GVIF"
"1"," Df"
"1"," GVIF^(1/(2*Df))"
"1","
Gender          "
"1","  2.840672"
"1","  1"
"1","        1.685429"
"1","
Amount_purchased"
"1","  1.557493"
"1","  1"
"1","        1.247995"
"1","
Frequency       "
"1","  5.711262"
"1","  1"
"1","        2.389825"
"1","
PredProb        "
"1","  9.293275"
"1","  1"
"1","        3.048487"
"1","
Pred_Y          "
"1","  2.918597"
"1","  1"
"1","        1.708390"
"1","
Fst_purch_bckt  "
"1","  9.882942"
"1","  3"
"1","        1.464922"
"1","
lst_purch_bckt  "
"1"," 11.917882"
"1","  3"
"1","        1.511355"
"1","
P_Child_bck     "
"1","  2.916640"
"1","  3"
"1","        1.195310"
"1","
P_Youth_bck     "
"1","  1.611551"
"1","  3"
"1","        1.082781"
"1","
P_Cook_bck      "
"1","  3.054951"
"1","  3"
"1","        1.204576"
"1","
P_DIY_bck       "
"1","  2.692842"
"1","  3"
"1","        1.179511"
"1","
P_Art_bck       "
"1"," 13.901294"
"1","  3"
"1","        1.550634"
"1","
"
"0","# Predict the probability on TEST - cutoff 0.5"
"0","test$PredProb <- predict.glm(glmf, newdata = test, type = 'response')"
"0",""
"0","#create Prediction Indicators for y"
"0","test$Pred_Y <- ifelse(test$PredProb >= 0.5, 1, 0)"
"0",""
"0","caret::confusionMatrix(as.factor(test$Choice),as.factor(test$Pred_Y), positive = '1') #this function and "
"1","Confusion Matrix and Statistics

"
"1","          Reference
"
"1","Prediction"
"1","    0"
"1","    1"
"1","
         0"
"1"," 2080"
"1","   16"
"1","
         1"
"1","  178"
"1","   26"
"1","
"
"1",""
"1","                         "
"1","                 "
"1","
"
"1","               Accuracy :"
"1"," 0.9157          "
"1","
"
"1","                 95% CI :"
"1"," (0.9035, 0.9267)"
"1","
"
"1","    No Information Rate :"
"1"," 0.9817          "
"1","
"
"1","    P-Value [Acc > NIR] :"
"1"," 1               "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1","                  Kappa :"
"1"," 0.1868          "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1"," Mcnemar's Test P-Value :"
"1"," <2e-16          "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1","            Sensitivity :"
"1"," 0.61905         "
"1","
"
"1","            Specificity :"
"1"," 0.92117         "
"1","
"
"1","         Pos Pred Value :"
"1"," 0.12745         "
"1","
"
"1","         Neg Pred Value :"
"1"," 0.99237         "
"1","
"
"1","             Prevalence :"
"1"," 0.01826         "
"1","
"
"1","         Detection Rate :"
"1"," 0.01130         "
"1","
"
"1","   Detection Prevalence :"
"1"," 0.08870         "
"1","
"
"1","      Balanced Accuracy :"
"1"," 0.77011         "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1","       'Positive' Class :"
"1"," 1               "
"1","
"
"1","                         "
"1","                 "
"1","
"
"0","## 91.57 Accuracy"
"0","## 62.5 Sensitivity"
"0","## 92.08 Specificity"
"0",""
