"0","#| echo: false"
"0","# creating binary numeric variable for linear model"
"0","str(df2)"
"1","'data.frame':	"
"1",""
"1","4119"
"1",""
"1"," obs. of  "
"1",""
"1","19"
"1",""
"1"," variable"
"1",""
"1","s"
"1",""
"1",":"
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","age           "
"1",""
"1",":"
"1"," int  "
"1",""
"1","30 39 25 38 47 32 32 41 31 35"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","job           "
"1",""
"1",":"
"1"," Factor w/ 12 levels ""admin."",""blue-collar"",..: "
"1",""
"1","2 8 8 8 1 8 1 3 8 2"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","married_ind   "
"1",""
"1",":"
"1"," num  "
"1",""
"1","1 0 1 1 1 0 0 1 0 1"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","education     "
"1",""
"1",":"
"1"," Factor w/ 8 levels ""basic.4y"",""basic.6y"",..: "
"1",""
"1","3 4 4 3 7 7 7 7 6 3"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","default       "
"1",""
"1",":"
"1"," Factor w/ 3 levels ""no"",""unknown"",..: "
"1",""
"1","1 1 1 1 1 1 1 2 1 2"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","housing       "
"1",""
"1",":"
"1"," Factor w/ 3 levels ""no"",""unknown"",..: "
"1",""
"1","3 1 3 2 3 1 3 3 1 1"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","loan          "
"1",""
"1",":"
"1"," Factor w/ 3 levels ""no"",""unknown"",..: "
"1",""
"1","1 1 1 2 1 1 1 1 1 1"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","contact       "
"1",""
"1",":"
"1"," Factor w/ 2 levels ""cellular"",""telephone"": "
"1",""
"1","1 2 2 2 1 1 1 1 1 2"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","campaign      "
"1",""
"1",":"
"1"," int  "
"1",""
"1","2 4 1 3 1 3 4 2 1 1"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","ppdays_ind    "
"1",""
"1",":"
"1"," num  "
"1",""
"1","0 0 0 0 0 0 0 0 0 0"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","previous      "
"1",""
"1",":"
"1"," int  "
"1",""
"1","0 0 0 0 0 2 0 0 1 0"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","poutcome      "
"1",""
"1",":"
"1"," Factor w/ 3 levels ""failure"",""nonexistent"",..: "
"1",""
"1","2 2 2 2 2 1 2 2 1 2"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","emp.var.rate  "
"1",""
"1",":"
"1"," num  "
"1",""
"1","-1.8 1.1 1.4 1.4 -0.1 -1.1 -1.1 -0.1 -0.1 1.1"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","cons.price.idx"
"1",""
"1",":"
"1"," num  "
"1",""
"1","92.9 94 94.5 94.5 93.2"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","cons.conf.idx "
"1",""
"1",":"
"1"," num  "
"1",""
"1","-46.2 -36.4 -41.8 -41.8 -42 -37.5 -37.5 -42 -42 -36.4"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","euribor3m     "
"1",""
"1",":"
"1"," num  "
"1",""
"1","1.31 4.86 4.96 4.96 4.19"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","nr.employed   "
"1",""
"1",":"
"1"," int  "
"1",""
"1","5099 5191 5228 5228 5195 4963 4963 5195 5195 5191"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","y             "
"1",""
"1",":"
"1"," Factor w/ 2 levels ""no"",""yes"": "
"1",""
"1","1 1 1 1 1 1 1 1 1 1"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","y_int         "
"1",""
"1",":"
"1"," num  "
"1",""
"1","0 0 0 0 0 0 0 0 0 0"
"1",""
"1"," ..."
"1",""
"1","
"
"0","# first exploring with backwards step selection on lm with full data"
"0","lm1 <- lm(y_int ~ . -y, data = df_train)"
"0","summary(lm1)"
"1","
Call:
"
"1",""
"1","lm(formula = y_int ~ . - y, data = df_train)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","     Min "
"1","      1Q "
"1","  Median "
"1","      3Q "
"1","     Max "
"1","
"
"1","-1.06778 "
"1","-0.32095 "
"1","-0.09389 "
"1"," 0.32241 "
"1"," 0.86898 "
"1","
"
"1","
Coefficients: ("
"1",""
"1","1"
"1",""
"1"," not defined because of singularities)
"
"1","                            "
"1","   Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept)                 "
"1"," -3.258e+01"
"1","  1.283e+01"
"1","  -2.539"
"1"," 0.011347"
"1"," *  "
"1","
age                         "
"1","  3.238e-03"
"1","  1.861e-03"
"1","   1.740"
"1"," 0.082298"
"1"," .  "
"1","
jobblue-collar              "
"1"," -4.909e-02"
"1","  6.569e-02"
"1","  -0.747"
"1"," 0.455094"
"1","    "
"1","
jobentrepreneur             "
"1"," -1.735e-01"
"1","  9.751e-02"
"1","  -1.779"
"1"," 0.075605"
"1"," .  "
"1","
jobhousemaid                "
"1"," -7.249e-02"
"1","  1.153e-01"
"1","  -0.629"
"1"," 0.529695"
"1","    "
"1","
jobmanagement               "
"1"," -1.049e-01"
"1","  7.021e-02"
"1","  -1.495"
"1"," 0.135494"
"1","    "
"1","
jobretired                  "
"1"," -6.815e-02"
"1","  8.948e-02"
"1","  -0.762"
"1"," 0.446538"
"1","    "
"1","
jobself-employed            "
"1"," -9.984e-02"
"1","  9.698e-02"
"1","  -1.030"
"1"," 0.303601"
"1","    "
"1","
jobservices                 "
"1"," -8.720e-02"
"1","  6.950e-02"
"1","  -1.255"
"1"," 0.210072"
"1","    "
"1","
jobstudent                  "
"1","  6.819e-02"
"1","  1.059e-01"
"1","   0.644"
"1"," 0.520055"
"1","    "
"1","
jobtechnician               "
"1"," -5.115e-02"
"1","  5.676e-02"
"1","  -0.901"
"1"," 0.367797"
"1","    "
"1","
jobunemployed               "
"1"," -1.328e-02"
"1","  9.302e-02"
"1","  -0.143"
"1"," 0.886528"
"1","    "
"1","
jobunknown                  "
"1","  1.078e-01"
"1","  1.872e-01"
"1","   0.576"
"1"," 0.564988"
"1","    "
"1","
married_ind                 "
"1"," -2.599e-02"
"1","  3.591e-02"
"1","  -0.724"
"1"," 0.469538"
"1","    "
"1","
educationbasic.6y           "
"1"," -9.565e-02"
"1","  9.503e-02"
"1","  -1.007"
"1"," 0.314517"
"1","    "
"1","
educationbasic.9y           "
"1"," -7.260e-02"
"1","  7.901e-02"
"1","  -0.919"
"1"," 0.358450"
"1","    "
"1","
educationhigh.school        "
"1"," -1.006e-01"
"1","  7.713e-02"
"1","  -1.304"
"1"," 0.192512"
"1","    "
"1","
educationprofessional.course"
"1"," -7.501e-02"
"1","  8.308e-02"
"1","  -0.903"
"1"," 0.366919"
"1","    "
"1","
educationuniversity.degree  "
"1"," -6.298e-02"
"1","  7.731e-02"
"1","  -0.815"
"1"," 0.415532"
"1","    "
"1","
educationunknown            "
"1"," -2.769e-02"
"1","  1.035e-01"
"1","  -0.268"
"1"," 0.789098"
"1","    "
"1","
defaultunknown              "
"1"," -1.736e-02"
"1","  5.006e-02"
"1","  -0.347"
"1"," 0.728856"
"1","    "
"1","
housingunknown              "
"1"," -9.859e-02"
"1","  1.099e-01"
"1","  -0.897"
"1"," 0.370157"
"1","    "
"1","
housingyes                  "
"1"," -2.935e-02"
"1","  3.363e-02"
"1","  -0.873"
"1"," 0.383115"
"1","    "
"1","
loanunknown                 "
"1","         NA"
"1","         NA"
"1","      NA"
"1","       NA"
"1","    "
"1","
loanyes                     "
"1","  1.994e-02"
"1","  4.595e-02"
"1","   0.434"
"1"," 0.664414"
"1","    "
"1","
contacttelephone            "
"1"," -1.633e-01"
"1","  4.891e-02"
"1","  -3.338"
"1"," 0.000890"
"1"," ***"
"1","
campaign                    "
"1"," -1.696e-02"
"1","  6.284e-03"
"1","  -2.698"
"1"," 0.007137"
"1"," ** "
"1","
ppdays_ind                  "
"1","  1.427e-01"
"1","  1.834e-01"
"1","   0.778"
"1"," 0.436924"
"1","    "
"1","
previous                    "
"1","  6.325e-03"
"1","  3.977e-02"
"1","   0.159"
"1"," 0.873680"
"1","    "
"1","
poutcomenonexistent         "
"1","  1.065e-01"
"1","  7.311e-02"
"1","   1.457"
"1"," 0.145678"
"1","    "
"1","
poutcomesuccess             "
"1","  2.310e-02"
"1","  1.769e-01"
"1","   0.131"
"1"," 0.896130"
"1","    "
"1","
emp.var.rate                "
"1"," -1.539e-01"
"1","  5.665e-02"
"1","  -2.717"
"1"," 0.006747"
"1"," ** "
"1","
cons.price.idx              "
"1","  3.207e-01"
"1","  8.417e-02"
"1","   3.810"
"1"," 0.000151"
"1"," ***"
"1","
cons.conf.idx               "
"1","  1.297e-02"
"1","  5.005e-03"
"1","   2.591"
"1"," 0.009785"
"1"," ** "
"1","
euribor3m                   "
"1"," -4.976e-02"
"1","  6.853e-02"
"1","  -0.726"
"1"," 0.468048"
"1","    "
"1","
nr.employed                 "
"1","  7.187e-04"
"1","  1.173e-03"
"1","   0.613"
"1"," 0.540163"
"1","    "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","0.4305"
"1"," "
"1","on"
"1"," "
"1","686"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.2945"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.2595"
"1"," "
"1","
F-statistic:"
"1"," "
"1","8.422"
"1"," "
"1","on"
"1"," "
"1","34"
"1"," "
"1","and"
"1"," "
"1","686"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","< 2.2e-16"
"1","
"
"1","
"
"0","lm1_step <- step(lm1, direction = ""backward"")"
"1","Start:  AIC="
"1",""
"1","-1181.07"
"1",""
"1","
"
"1",""
"1","y_int ~ (age + job + married_ind + education + default + housing + "
"1",""
"1","
    loan + contact + campaign + ppdays_ind + previous + poutcome + "
"1",""
"1","
    emp.var.rate + cons.price.idx + cons.conf.idx + euribor3m + "
"1",""
"1","
    nr.employed + y) - y"
"1",""
"1","

"
"1","                "
"1"," Df"
"1"," Sum of Sq"
"1","    RSS"
"1","     AIC"
"1","
- job           "
"1"," 11"
"1","   1.46981"
"1"," 128.63"
"1"," -1194.8"
"1","
- education     "
"1","  6"
"1","   0.43002"
"1"," 127.59"
"1"," -1190.6"
"1","
- previous      "
"1","  1"
"1","   0.00469"
"1"," 127.17"
"1"," -1183.0"
"1","
- default       "
"1","  1"
"1","   0.02229"
"1"," 127.18"
"1"," -1182.9"
"1","
- loan          "
"1","  1"
"1","   0.03492"
"1"," 127.20"
"1"," -1182.9"
"1","
- poutcome      "
"1","  2"
"1","   0.39384"
"1"," 127.56"
"1"," -1182.8"
"1","
- nr.employed   "
"1","  1"
"1","   0.06963"
"1"," 127.23"
"1"," -1182.7"
"1","
- married_ind   "
"1","  1"
"1","   0.09707"
"1"," 127.26"
"1"," -1182.5"
"1","
- euribor3m     "
"1","  1"
"1","   0.09772"
"1"," 127.26"
"1"," -1182.5"
"1","
- ppdays_ind    "
"1","  1"
"1","   0.11216"
"1"," 127.27"
"1"," -1182.4"
"1","
- housing       "
"1","  1"
"1","   0.14119"
"1"," 127.30"
"1"," -1182.3"
"1","
<none>          "
"1","   "
"1","          "
"1"," 127.16"
"1"," -1181.1"
"1","
- age           "
"1","  1"
"1","   0.56125"
"1"," 127.72"
"1"," -1179.9"
"1","
- cons.conf.idx "
"1","  1"
"1","   1.24402"
"1"," 128.41"
"1"," -1176.0"
"1","
- campaign      "
"1","  1"
"1","   1.34979"
"1"," 128.51"
"1"," -1175.5"
"1","
- emp.var.rate  "
"1","  1"
"1","   1.36872"
"1"," 128.53"
"1"," -1175.3"
"1","
- contact       "
"1","  1"
"1","   2.06509"
"1"," 129.23"
"1"," -1171.5"
"1","
- cons.price.idx"
"1","  1"
"1","   2.69088"
"1"," 129.85"
"1"," -1168.0"
"1","
"
"1","
Step:  AIC="
"1",""
"1","-1194.78"
"1",""
"1","
"
"1",""
"1","y_int ~ age + married_ind + education + default + housing + loan + "
"1",""
"1","
    contact + campaign + ppdays_ind + previous + poutcome + emp.var.rate + "
"1",""
"1","
    cons.price.idx + cons.conf.idx + euribor3m + nr.employed"
"1",""
"1","

"
"1","                "
"1"," Df"
"1"," Sum of Sq"
"1","    RSS"
"1","     AIC"
"1","
- education     "
"1","  6"
"1","   0.46535"
"1"," 129.10"
"1"," -1204.2"
"1","
- poutcome      "
"1","  2"
"1","   0.32919"
"1"," 128.96"
"1"," -1196.9"
"1","
- previous      "
"1","  1"
"1","   0.00140"
"1"," 128.63"
"1"," -1196.8"
"1","
- loan          "
"1","  1"
"1","   0.01534"
"1"," 128.65"
"1"," -1196.7"
"1","
- default       "
"1","  1"
"1","   0.01650"
"1"," 128.65"
"1"," -1196.7"
"1","
- nr.employed   "
"1","  1"
"1","   0.06561"
"1"," 128.70"
"1"," -1196.4"
"1","
- euribor3m     "
"1","  1"
"1","   0.10161"
"1"," 128.73"
"1"," -1196.2"
"1","
- housing       "
"1","  1"
"1","   0.13841"
"1"," 128.77"
"1"," -1196.0"
"1","
- married_ind   "
"1","  1"
"1","   0.16905"
"1"," 128.80"
"1"," -1195.8"
"1","
- ppdays_ind    "
"1","  1"
"1","   0.18628"
"1"," 128.82"
"1"," -1195.7"
"1","
<none>          "
"1","   "
"1","          "
"1"," 128.63"
"1"," -1194.8"
"1","
- age           "
"1","  1"
"1","   0.48504"
"1"," 129.12"
"1"," -1194.1"
"1","
- cons.conf.idx "
"1","  1"
"1","   1.28115"
"1"," 129.91"
"1"," -1189.6"
"1","
- emp.var.rate  "
"1","  1"
"1","   1.38232"
"1"," 130.01"
"1"," -1189.1"
"1","
- campaign      "
"1","  1"
"1","   1.40688"
"1"," 130.04"
"1"," -1188.9"
"1","
- contact       "
"1","  1"
"1","   2.17519"
"1"," 130.81"
"1"," -1184.7"
"1","
- cons.price.idx"
"1","  1"
"1","   2.76955"
"1"," 131.40"
"1"," -1181.4"
"1","
"
"1","
Step:  AIC="
"1",""
"1","-1204.18"
"1",""
"1","
"
"1",""
"1","y_int ~ age + married_ind + default + housing + loan + contact + "
"1",""
"1","
    campaign + ppdays_ind + previous + poutcome + emp.var.rate + "
"1",""
"1","
    cons.price.idx + cons.conf.idx + euribor3m + nr.employed"
"1",""
"1","

"
"1","                "
"1"," Df"
"1"," Sum of Sq"
"1","    RSS"
"1","     AIC"
"1","
- previous      "
"1","  1"
"1","   0.00066"
"1"," 129.10"
"1"," -1206.2"
"1","
- default       "
"1","  1"
"1","   0.00284"
"1"," 129.10"
"1"," -1206.2"
"1","
- loan          "
"1","  1"
"1","   0.01866"
"1"," 129.12"
"1"," -1206.1"
"1","
- poutcome      "
"1","  2"
"1","   0.38777"
"1"," 129.48"
"1"," -1206.0"
"1","
- nr.employed   "
"1","  1"
"1","   0.07193"
"1"," 129.17"
"1"," -1205.8"
"1","
- euribor3m     "
"1","  1"
"1","   0.10699"
"1"," 129.20"
"1"," -1205.6"
"1","
- housing       "
"1","  1"
"1","   0.16933"
"1"," 129.27"
"1"," -1205.2"
"1","
- ppdays_ind    "
"1","  1"
"1","   0.18747"
"1"," 129.28"
"1"," -1205.1"
"1","
- married_ind   "
"1","  1"
"1","   0.20365"
"1"," 129.30"
"1"," -1205.0"
"1","
<none>          "
"1","   "
"1","          "
"1"," 129.10"
"1"," -1204.2"
"1","
- age           "
"1","  1"
"1","   0.86858"
"1"," 129.97"
"1"," -1201.3"
"1","
- cons.conf.idx "
"1","  1"
"1","   1.35780"
"1"," 130.45"
"1"," -1198.6"
"1","
- emp.var.rate  "
"1","  1"
"1","   1.41636"
"1"," 130.51"
"1"," -1198.3"
"1","
- campaign      "
"1","  1"
"1","   1.55918"
"1"," 130.66"
"1"," -1197.5"
"1","
- contact       "
"1","  1"
"1","   2.20465"
"1"," 131.30"
"1"," -1194.0"
"1","
- cons.price.idx"
"1","  1"
"1","   2.83661"
"1"," 131.93"
"1"," -1190.5"
"1","
"
"1","
Step:  AIC="
"1",""
"1","-1206.17"
"1",""
"1","
"
"1",""
"1","y_int ~ age + married_ind + default + housing + loan + contact + "
"1",""
"1","
    campaign + ppdays_ind + poutcome + emp.var.rate + cons.price.idx + "
"1",""
"1","
    cons.conf.idx + euribor3m + nr.employed"
"1",""
"1","

"
"1","                "
"1"," Df"
"1"," Sum of Sq"
"1","    RSS"
"1","     AIC"
"1","
- default       "
"1","  1"
"1","   0.00282"
"1"," 129.10"
"1"," -1208.2"
"1","
- loan          "
"1","  1"
"1","   0.01838"
"1"," 129.12"
"1"," -1208.1"
"1","
- nr.employed   "
"1","  1"
"1","   0.07221"
"1"," 129.17"
"1"," -1207.8"
"1","
- euribor3m     "
"1","  1"
"1","   0.10662"
"1"," 129.20"
"1"," -1207.6"
"1","
- housing       "
"1","  1"
"1","   0.17052"
"1"," 129.27"
"1"," -1207.2"
"1","
- ppdays_ind    "
"1","  1"
"1","   0.20146"
"1"," 129.30"
"1"," -1207.0"
"1","
- married_ind   "
"1","  1"
"1","   0.20302"
"1"," 129.30"
"1"," -1207.0"
"1","
- poutcome      "
"1","  2"
"1","   0.65306"
"1"," 129.75"
"1"," -1206.5"
"1","
<none>          "
"1","   "
"1","          "
"1"," 129.10"
"1"," -1206.2"
"1","
- age           "
"1","  1"
"1","   0.88913"
"1"," 129.99"
"1"," -1203.2"
"1","
- cons.conf.idx "
"1","  1"
"1","   1.35724"
"1"," 130.46"
"1"," -1200.6"
"1","
- emp.var.rate  "
"1","  1"
"1","   1.42048"
"1"," 130.52"
"1"," -1200.3"
"1","
- campaign      "
"1","  1"
"1","   1.55854"
"1"," 130.66"
"1"," -1199.5"
"1","
- contact       "
"1","  1"
"1","   2.20753"
"1"," 131.31"
"1"," -1196.0"
"1","
- cons.price.idx"
"1","  1"
"1","   2.84154"
"1"," 131.94"
"1"," -1192.5"
"1","
"
"1","
Step:  AIC="
"1",""
"1","-1208.16"
"1",""
"1","
"
"1",""
"1","y_int ~ age + married_ind + housing + loan + contact + campaign + "
"1",""
"1","
    ppdays_ind + poutcome + emp.var.rate + cons.price.idx + cons.conf.idx + "
"1",""
"1","
    euribor3m + nr.employed"
"1",""
"1","

"
"1","                "
"1"," Df"
"1"," Sum of Sq"
"1","    RSS"
"1","     AIC"
"1","
- loan          "
"1","  1"
"1","   0.01841"
"1"," 129.12"
"1"," -1210.0"
"1","
- nr.employed   "
"1","  1"
"1","   0.07107"
"1"," 129.17"
"1"," -1209.8"
"1","
- euribor3m     "
"1","  1"
"1","   0.10591"
"1"," 129.21"
"1"," -1209.6"
"1","
- housing       "
"1","  1"
"1","   0.16909"
"1"," 129.27"
"1"," -1209.2"
"1","
- ppdays_ind    "
"1","  1"
"1","   0.20294"
"1"," 129.30"
"1"," -1209.0"
"1","
- married_ind   "
"1","  1"
"1","   0.20461"
"1"," 129.31"
"1"," -1209.0"
"1","
- poutcome      "
"1","  2"
"1","   0.66313"
"1"," 129.76"
"1"," -1208.5"
"1","
<none>          "
"1","   "
"1","          "
"1"," 129.10"
"1"," -1208.2"
"1","
- age           "
"1","  1"
"1","   0.89057"
"1"," 129.99"
"1"," -1205.2"
"1","
- cons.conf.idx "
"1","  1"
"1","   1.35547"
"1"," 130.46"
"1"," -1202.6"
"1","
- emp.var.rate  "
"1","  1"
"1","   1.42272"
"1"," 130.52"
"1"," -1202.2"
"1","
- campaign      "
"1","  1"
"1","   1.55823"
"1"," 130.66"
"1"," -1201.5"
"1","
- contact       "
"1","  1"
"1","   2.24485"
"1"," 131.34"
"1"," -1197.7"
"1","
- cons.price.idx"
"1","  1"
"1","   2.83891"
"1"," 131.94"
"1"," -1194.5"
"1","
"
"1","
Step:  AIC="
"1",""
"1","-1210.05"
"1",""
"1","
"
"1",""
"1","y_int ~ age + married_ind + housing + contact + campaign + ppdays_ind + "
"1",""
"1","
    poutcome + emp.var.rate + cons.price.idx + cons.conf.idx + "
"1",""
"1","
    euribor3m + nr.employed"
"1",""
"1","

"
"1","                "
"1"," Df"
"1"," Sum of Sq"
"1","    RSS"
"1","     AIC"
"1","
- housing       "
"1","  2"
"1","   0.37384"
"1"," 129.49"
"1"," -1212.0"
"1","
- nr.employed   "
"1","  1"
"1","   0.07410"
"1"," 129.19"
"1"," -1211.6"
"1","
- euribor3m     "
"1","  1"
"1","   0.10750"
"1"," 129.23"
"1"," -1211.5"
"1","
- married_ind   "
"1","  1"
"1","   0.20283"
"1"," 129.32"
"1"," -1210.9"
"1","
- ppdays_ind    "
"1","  1"
"1","   0.20759"
"1"," 129.33"
"1"," -1210.9"
"1","
- poutcome      "
"1","  2"
"1","   0.66840"
"1"," 129.79"
"1"," -1210.3"
"1","
<none>          "
"1","   "
"1","          "
"1"," 129.12"
"1"," -1210.0"
"1","
- age           "
"1","  1"
"1","   0.88763"
"1"," 130.01"
"1"," -1207.1"
"1","
- cons.conf.idx "
"1","  1"
"1","   1.37643"
"1"," 130.50"
"1"," -1204.4"
"1","
- emp.var.rate  "
"1","  1"
"1","   1.43174"
"1"," 130.55"
"1"," -1204.1"
"1","
- campaign      "
"1","  1"
"1","   1.57959"
"1"," 130.70"
"1"," -1203.3"
"1","
- contact       "
"1","  1"
"1","   2.25108"
"1"," 131.37"
"1"," -1199.6"
"1","
- cons.price.idx"
"1","  1"
"1","   2.86077"
"1"," 131.98"
"1"," -1196.2"
"1","
"
"1","
Step:  AIC="
"1",""
"1","-1211.97"
"1",""
"1","
"
"1",""
"1","y_int ~ age + married_ind + contact + campaign + ppdays_ind + "
"1",""
"1","
    poutcome + emp.var.rate + cons.price.idx + cons.conf.idx + "
"1",""
"1","
    euribor3m + nr.employed"
"1",""
"1","

"
"1","                "
"1"," Df"
"1"," Sum of Sq"
"1","    RSS"
"1","     AIC"
"1","
- nr.employed   "
"1","  1"
"1","   0.06066"
"1"," 129.55"
"1"," -1213.6"
"1","
- euribor3m     "
"1","  1"
"1","   0.09520"
"1"," 129.59"
"1"," -1213.4"
"1","
- married_ind   "
"1","  1"
"1","   0.19751"
"1"," 129.69"
"1"," -1212.9"
"1","
- ppdays_ind    "
"1","  1"
"1","   0.21163"
"1"," 129.70"
"1"," -1212.8"
"1","
<none>          "
"1","   "
"1","          "
"1"," 129.49"
"1"," -1212.0"
"1","
- poutcome      "
"1","  2"
"1","   0.75548"
"1"," 130.25"
"1"," -1211.8"
"1","
- age           "
"1","  1"
"1","   0.89230"
"1"," 130.38"
"1"," -1209.0"
"1","
- cons.conf.idx "
"1","  1"
"1","   1.36551"
"1"," 130.86"
"1"," -1206.4"
"1","
- emp.var.rate  "
"1","  1"
"1","   1.43687"
"1"," 130.93"
"1"," -1206.0"
"1","
- campaign      "
"1","  1"
"1","   1.54451"
"1"," 131.04"
"1"," -1205.4"
"1","
- contact       "
"1","  1"
"1","   2.17167"
"1"," 131.66"
"1"," -1202.0"
"1","
- cons.price.idx"
"1","  1"
"1","   2.85624"
"1"," 132.35"
"1"," -1198.2"
"1","
"
"1","
Step:  AIC="
"1",""
"1","-1213.63"
"1",""
"1","
"
"1",""
"1","y_int ~ age + married_ind + contact + campaign + ppdays_ind + "
"1",""
"1","
    poutcome + emp.var.rate + cons.price.idx + cons.conf.idx + "
"1",""
"1","
    euribor3m"
"1",""
"1","

"
"1","                "
"1"," Df"
"1"," Sum of Sq"
"1","    RSS"
"1","     AIC"
"1","
- euribor3m     "
"1","  1"
"1","    0.0350"
"1"," 129.59"
"1"," -1215.4"
"1","
- married_ind   "
"1","  1"
"1","    0.1875"
"1"," 129.74"
"1"," -1214.6"
"1","
- ppdays_ind    "
"1","  1"
"1","    0.2068"
"1"," 129.76"
"1"," -1214.5"
"1","
<none>          "
"1","   "
"1","          "
"1"," 129.55"
"1"," -1213.6"
"1","
- poutcome      "
"1","  2"
"1","    0.7615"
"1"," 130.31"
"1"," -1213.4"
"1","
- age           "
"1","  1"
"1","    0.8860"
"1"," 130.44"
"1"," -1210.7"
"1","
- emp.var.rate  "
"1","  1"
"1","    1.3765"
"1"," 130.93"
"1"," -1208.0"
"1","
- campaign      "
"1","  1"
"1","    1.4943"
"1"," 131.05"
"1"," -1207.4"
"1","
- cons.conf.idx "
"1","  1"
"1","    1.8819"
"1"," 131.44"
"1"," -1205.2"
"1","
- contact       "
"1","  1"
"1","    2.1200"
"1"," 131.67"
"1"," -1203.9"
"1","
- cons.price.idx"
"1","  1"
"1","    5.4656"
"1"," 135.02"
"1"," -1185.8"
"1","
"
"1","
Step:  AIC="
"1",""
"1","-1215.44"
"1",""
"1","
"
"1",""
"1","y_int ~ age + married_ind + contact + campaign + ppdays_ind + "
"1",""
"1","
    poutcome + emp.var.rate + cons.price.idx + cons.conf.idx"
"1",""
"1","

"
"1","                "
"1"," Df"
"1"," Sum of Sq"
"1","    RSS"
"1","     AIC"
"1","
- married_ind   "
"1","  1"
"1","    0.1942"
"1"," 129.78"
"1"," -1216.4"
"1","
- ppdays_ind    "
"1","  1"
"1","    0.2103"
"1"," 129.80"
"1"," -1216.3"
"1","
<none>          "
"1","   "
"1","          "
"1"," 129.59"
"1"," -1215.4"
"1","
- poutcome      "
"1","  2"
"1","    0.7422"
"1"," 130.33"
"1"," -1215.3"
"1","
- age           "
"1","  1"
"1","    0.9104"
"1"," 130.50"
"1"," -1212.4"
"1","
- campaign      "
"1","  1"
"1","    1.5006"
"1"," 131.09"
"1"," -1209.1"
"1","
- cons.conf.idx "
"1","  1"
"1","    1.8830"
"1"," 131.47"
"1"," -1207.0"
"1","
- contact       "
"1","  1"
"1","    2.5381"
"1"," 132.13"
"1"," -1203.5"
"1","
- cons.price.idx"
"1","  1"
"1","    9.4858"
"1"," 139.07"
"1"," -1166.5"
"1","
- emp.var.rate  "
"1","  1"
"1","   20.9606"
"1"," 150.55"
"1"," -1109.3"
"1","
"
"1","
Step:  AIC="
"1",""
"1","-1216.36"
"1",""
"1","
"
"1",""
"1","y_int ~ age + contact + campaign + ppdays_ind + poutcome + emp.var.rate + "
"1",""
"1","
    cons.price.idx + cons.conf.idx"
"1",""
"1","

"
"1","                "
"1"," Df"
"1"," Sum of Sq"
"1","    RSS"
"1","     AIC"
"1","
- ppdays_ind    "
"1","  1"
"1","    0.2171"
"1"," 130.00"
"1"," -1217.2"
"1","
<none>          "
"1","   "
"1","          "
"1"," 129.78"
"1"," -1216.4"
"1","
- poutcome      "
"1","  2"
"1","    0.7733"
"1"," 130.56"
"1"," -1216.1"
"1","
- age           "
"1","  1"
"1","    0.7350"
"1"," 130.52"
"1"," -1214.3"
"1","
- campaign      "
"1","  1"
"1","    1.4753"
"1"," 131.26"
"1"," -1210.2"
"1","
- cons.conf.idx "
"1","  1"
"1","    1.9255"
"1"," 131.71"
"1"," -1207.7"
"1","
- contact       "
"1","  1"
"1","    2.6051"
"1"," 132.39"
"1"," -1204.0"
"1","
- cons.price.idx"
"1","  1"
"1","    9.6209"
"1"," 139.40"
"1"," -1166.8"
"1","
- emp.var.rate  "
"1","  1"
"1","   21.7162"
"1"," 151.50"
"1"," -1106.8"
"1","
"
"1","
Step:  AIC="
"1",""
"1","-1217.15"
"1",""
"1","
"
"1",""
"1","y_int ~ age + contact + campaign + poutcome + emp.var.rate + "
"1",""
"1","
    cons.price.idx + cons.conf.idx"
"1",""
"1","

"
"1","                "
"1"," Df"
"1"," Sum of Sq"
"1","    RSS"
"1","     AIC"
"1","
<none>          "
"1","   "
"1","          "
"1"," 130.00"
"1"," -1217.2"
"1","
- age           "
"1","  1"
"1","    0.7079"
"1"," 130.71"
"1"," -1215.2"
"1","
- poutcome      "
"1","  2"
"1","    1.1503"
"1"," 131.15"
"1"," -1214.8"
"1","
- campaign      "
"1","  1"
"1","    1.4604"
"1"," 131.46"
"1"," -1211.1"
"1","
- cons.conf.idx "
"1","  1"
"1","    2.0894"
"1"," 132.09"
"1"," -1207.7"
"1","
- contact       "
"1","  1"
"1","    2.6707"
"1"," 132.67"
"1"," -1204.5"
"1","
- cons.price.idx"
"1","  1"
"1","    9.8878"
"1"," 139.89"
"1"," -1166.3"
"1","
- emp.var.rate  "
"1","  1"
"1","   22.0697"
"1"," 152.07"
"1"," -1106.1"
"1","
"
"0","summary(lm1_step)"
"1","
Call:
"
"1",""
"1","lm(formula = y_int ~ age + contact + campaign + poutcome + emp.var.rate + 
    cons.price.idx + cons.conf.idx, data = df_train)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","     Min "
"1","      1Q "
"1","  Median "
"1","      3Q "
"1","     Max "
"1","
"
"1","-1.03746 "
"1","-0.32677 "
"1","-0.06865 "
"1"," 0.34689 "
"1"," 0.90629 "
"1","
"
"1","
Coefficients:
"
"1","                   "
"1","   Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept)        "
"1"," -27.807890"
"1","   3.836511"
"1","  -7.248"
"1"," 1.10e-12"
"1"," ***"
"1","
age                "
"1","   0.002718"
"1","   0.001380"
"1","   1.969"
"1"," 0.049333"
"1"," *  "
"1","
contacttelephone   "
"1","  -0.165558"
"1","   0.043288"
"1","  -3.825"
"1"," 0.000142"
"1"," ***"
"1","
campaign           "
"1","  -0.017232"
"1","   0.006093"
"1","  -2.828"
"1"," 0.004813"
"1"," ** "
"1","
poutcomenonexistent"
"1","   0.099466"
"1","   0.053596"
"1","   1.856"
"1"," 0.063887"
"1"," .  "
"1","
poutcomesuccess    "
"1","   0.168443"
"1","   0.069832"
"1","   2.412"
"1"," 0.016111"
"1"," *  "
"1","
emp.var.rate       "
"1","  -0.175603"
"1","   0.015972"
"1"," -10.994"
"1","  < 2e-16"
"1"," ***"
"1","
cons.price.idx     "
"1","   0.305554"
"1","   0.041521"
"1","   7.359"
"1"," 5.12e-13"
"1"," ***"
"1","
cons.conf.idx      "
"1","   0.011460"
"1","   0.003388"
"1","   3.383"
"1"," 0.000757"
"1"," ***"
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","0.4273"
"1"," "
"1","on"
"1"," "
"1","712"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.2787"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.2706"
"1"," "
"1","
F-statistic:"
"1"," "
"1"," 34.4"
"1"," "
"1","on"
"1"," "
"1","8"
"1"," "
"1","and"
"1"," "
"1","712"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","< 2.2e-16"
"1","
"
"1","
"
"0","# final lm model base off of step "
"0","lmf <- lm(y_int ~ age + contact + campaign + poutcome + emp.var.rate + "
"0","    cons.price.idx + cons.conf.idx, data = df_train)"
"0","#summary(lmf)"
"0",""
"0","vif(lmf) # confirm there is no co linearity "
"1","              "
"1","     GVIF"
"1"," Df"
"1"," GVIF^(1/(2*Df))"
"1","
age           "
"1"," 1.021693"
"1","  1"
"1","        1.010788"
"1","
contact       "
"1"," 1.478643"
"1","  1"
"1","        1.215995"
"1","
campaign      "
"1"," 1.062973"
"1","  1"
"1","        1.031006"
"1","
poutcome      "
"1"," 1.678361"
"1","  2"
"1","        1.138207"
"1","
emp.var.rate  "
"1"," 2.924730"
"1","  1"
"1","        1.710184"
"1","
cons.price.idx"
"1"," 2.703450"
"1","  1"
"1","        1.644217"
"1","
cons.conf.idx "
"1"," 1.227186"
"1","  1"
"1","        1.107784"
"1","
"
"0","# R- Squared is very small at 27% but is expectedc since y is binomial"
"0",""
"0",""
"0","### LETS TRY SAME TECHNIQUE BUT WITH LOGISTIC MODEL"
"0","#glm model"
"0","glm1 <- glm(y_int ~ . -y, data = df_train, family = binomial) #Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred"
"0","summary(glm1)"
"1","
Call:
"
"1",""
"1","glm(formula = y_int ~ . - y, family = binomial, data = df_train)"
"1",""
"1","
"
"1","
Coefficients: ("
"1",""
"1","1"
"1",""
"1"," not defined because of singularities)
"
"1","                            "
"1","   Estimate"
"1"," Std. Error"
"1"," z value"
"1"," Pr(>|z|)"
"1","    "
"1","
(Intercept)                 "
"1"," -1.650e+02"
"1","  7.382e+01"
"1","  -2.234"
"1"," 0.025454"
"1"," *  "
"1","
age                         "
"1","  2.032e-02"
"1","  1.063e-02"
"1","   1.912"
"1"," 0.055855"
"1"," .  "
"1","
jobblue-collar              "
"1"," -3.444e-01"
"1","  3.479e-01"
"1","  -0.990"
"1"," 0.322228"
"1","    "
"1","
jobentrepreneur             "
"1"," -9.684e-01"
"1","  5.510e-01"
"1","  -1.758"
"1"," 0.078808"
"1"," .  "
"1","
jobhousemaid                "
"1"," -3.506e-01"
"1","  6.541e-01"
"1","  -0.536"
"1"," 0.591966"
"1","    "
"1","
jobmanagement               "
"1"," -5.938e-01"
"1","  3.846e-01"
"1","  -1.544"
"1"," 0.122579"
"1","    "
"1","
jobretired                  "
"1"," -3.962e-01"
"1","  5.187e-01"
"1","  -0.764"
"1"," 0.444967"
"1","    "
"1","
jobself-employed            "
"1"," -5.612e-01"
"1","  5.285e-01"
"1","  -1.062"
"1"," 0.288285"
"1","    "
"1","
jobservices                 "
"1"," -5.562e-01"
"1","  4.019e-01"
"1","  -1.384"
"1"," 0.166425"
"1","    "
"1","
jobstudent                  "
"1","  4.042e-01"
"1","  6.142e-01"
"1","   0.658"
"1"," 0.510459"
"1","    "
"1","
jobtechnician               "
"1"," -3.351e-01"
"1","  3.195e-01"
"1","  -1.049"
"1"," 0.294285"
"1","    "
"1","
jobunemployed               "
"1"," -1.620e-01"
"1","  5.384e-01"
"1","  -0.301"
"1"," 0.763500"
"1","    "
"1","
jobunknown                  "
"1","  3.424e-01"
"1","  1.024e+00"
"1","   0.334"
"1"," 0.738153"
"1","    "
"1","
married_ind                 "
"1"," -1.308e-01"
"1","  1.977e-01"
"1","  -0.662"
"1"," 0.508156"
"1","    "
"1","
educationbasic.6y           "
"1"," -4.001e-01"
"1","  5.047e-01"
"1","  -0.793"
"1"," 0.427950"
"1","    "
"1","
educationbasic.9y           "
"1"," -3.571e-01"
"1","  4.199e-01"
"1","  -0.851"
"1"," 0.395019"
"1","    "
"1","
educationhigh.school        "
"1"," -5.658e-01"
"1","  4.220e-01"
"1","  -1.341"
"1"," 0.180003"
"1","    "
"1","
educationprofessional.course"
"1"," -3.484e-01"
"1","  4.601e-01"
"1","  -0.757"
"1"," 0.448925"
"1","    "
"1","
educationuniversity.degree  "
"1"," -3.417e-01"
"1","  4.247e-01"
"1","  -0.805"
"1"," 0.420980"
"1","    "
"1","
educationunknown            "
"1"," -5.744e-02"
"1","  5.862e-01"
"1","  -0.098"
"1"," 0.921944"
"1","    "
"1","
defaultunknown              "
"1"," -1.073e-01"
"1","  2.692e-01"
"1","  -0.399"
"1"," 0.690122"
"1","    "
"1","
housingunknown              "
"1"," -7.548e-01"
"1","  7.070e-01"
"1","  -1.068"
"1"," 0.285662"
"1","    "
"1","
housingyes                  "
"1"," -1.778e-01"
"1","  1.877e-01"
"1","  -0.947"
"1"," 0.343688"
"1","    "
"1","
loanunknown                 "
"1","         NA"
"1","         NA"
"1","      NA"
"1","       NA"
"1","    "
"1","
loanyes                     "
"1","  9.128e-02"
"1","  2.493e-01"
"1","   0.366"
"1"," 0.714189"
"1","    "
"1","
contacttelephone            "
"1"," -9.722e-01"
"1","  2.782e-01"
"1","  -3.495"
"1"," 0.000474"
"1"," ***"
"1","
campaign                    "
"1"," -1.312e-01"
"1","  4.989e-02"
"1","  -2.630"
"1"," 0.008548"
"1"," ** "
"1","
ppdays_ind                  "
"1","  6.868e-03"
"1","  1.438e+00"
"1","   0.005"
"1"," 0.996190"
"1","    "
"1","
previous                    "
"1","  7.119e-01"
"1","  5.657e-01"
"1","   1.258"
"1"," 0.208254"
"1","    "
"1","
poutcomenonexistent         "
"1","  1.303e+00"
"1","  6.956e-01"
"1","   1.874"
"1"," 0.060976"
"1"," .  "
"1","
poutcomesuccess             "
"1","  1.222e+00"
"1","  1.465e+00"
"1","   0.834"
"1"," 0.404197"
"1","    "
"1","
emp.var.rate                "
"1"," -7.462e-01"
"1","  3.427e-01"
"1","  -2.178"
"1"," 0.029435"
"1"," *  "
"1","
cons.price.idx              "
"1","  1.766e+00"
"1","  4.839e-01"
"1","   3.650"
"1"," 0.000262"
"1"," ***"
"1","
cons.conf.idx               "
"1","  6.035e-02"
"1","  3.002e-02"
"1","   2.010"
"1"," 0.044417"
"1"," *  "
"1","
euribor3m                   "
"1"," -1.302e-01"
"1","  4.012e-01"
"1","  -0.324"
"1"," 0.745611"
"1","    "
"1","
nr.employed                 "
"1","  3.225e-04"
"1","  7.138e-03"
"1","   0.045"
"1"," 0.963960"
"1","    "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
(Dispersion parameter for "
"1",""
"1","binomial"
"1",""
"1"," family taken to be "
"1",""
"1","1"
"1",""
"1",")

"
"1",""
"1","    Null deviance: 999.48  on 720  degrees of freedom
"
"1",""
"1","Residual deviance: 748.61  on 686  degrees of freedom
"
"1","AIC: "
"1",""
"1","818.61"
"1",""
"1","

"
"1",""
"1","Number of Fisher Scoring iterations: "
"1",""
"1","6"
"1",""
"1","
"
"1","
"
"0","# using backwards Step Selection"
"0","glm_step = step(glm1, direction = ""backward"") # stepwise backward elim."
"1","Start:  AIC="
"1",""
"1","818.61"
"1",""
"1","
"
"1",""
"1","y_int ~ (age + job + married_ind + education + default + housing + "
"1",""
"1","
    loan + contact + campaign + ppdays_ind + previous + poutcome + "
"1",""
"1","
    emp.var.rate + cons.price.idx + cons.conf.idx + euribor3m + "
"1",""
"1","
    nr.employed + y) - y"
"1",""
"1","

"
"1","                "
"1"," Df"
"1"," Deviance"
"1","    AIC"
"1","
- job           "
"1"," 11"
"1","   756.79"
"1"," 804.79"
"1","
- education     "
"1","  6"
"1","   750.96"
"1"," 808.96"
"1","
- ppdays_ind    "
"1","  1"
"1","   748.61"
"1"," 816.61"
"1","
- nr.employed   "
"1","  1"
"1","   748.61"
"1"," 816.61"
"1","
- euribor3m     "
"1","  1"
"1","   748.72"
"1"," 816.72"
"1","
- loan          "
"1","  1"
"1","   748.75"
"1"," 816.75"
"1","
- default       "
"1","  1"
"1","   748.77"
"1"," 816.77"
"1","
- married_ind   "
"1","  1"
"1","   749.05"
"1"," 817.05"
"1","
- housing       "
"1","  1"
"1","   749.51"
"1"," 817.51"
"1","
- previous      "
"1","  1"
"1","   750.59"
"1"," 818.59"
"1","
<none>          "
"1","   "
"1","   748.61"
"1"," 818.61"
"1","
- poutcome      "
"1","  2"
"1","   752.95"
"1"," 818.95"
"1","
- age           "
"1","  1"
"1","   752.30"
"1"," 820.30"
"1","
- cons.conf.idx "
"1","  1"
"1","   752.69"
"1"," 820.69"
"1","
- emp.var.rate  "
"1","  1"
"1","   753.53"
"1"," 821.53"
"1","
- campaign      "
"1","  1"
"1","   757.56"
"1"," 825.56"
"1","
- contact       "
"1","  1"
"1","   761.23"
"1"," 829.23"
"1","
- cons.price.idx"
"1","  1"
"1","   762.10"
"1"," 830.10"
"1","
"
"1","
Step:  AIC="
"1",""
"1","804.79"
"1",""
"1","
"
"1",""
"1","y_int ~ age + married_ind + education + default + housing + loan + "
"1",""
"1","
    contact + campaign + ppdays_ind + previous + poutcome + emp.var.rate + "
"1",""
"1","
    cons.price.idx + cons.conf.idx + euribor3m + nr.employed"
"1",""
"1","

"
"1","                "
"1"," Df"
"1"," Deviance"
"1","    AIC"
"1","
- education     "
"1","  6"
"1","   759.37"
"1"," 795.37"
"1","
- nr.employed   "
"1","  1"
"1","   756.79"
"1"," 802.79"
"1","
- loan          "
"1","  1"
"1","   756.85"
"1"," 802.85"
"1","
- ppdays_ind    "
"1","  1"
"1","   756.86"
"1"," 802.86"
"1","
- default       "
"1","  1"
"1","   756.90"
"1"," 802.90"
"1","
- euribor3m     "
"1","  1"
"1","   756.95"
"1"," 802.95"
"1","
- housing       "
"1","  1"
"1","   757.59"
"1"," 803.59"
"1","
- married_ind   "
"1","  1"
"1","   757.62"
"1"," 803.62"
"1","
- previous      "
"1","  1"
"1","   758.33"
"1"," 804.33"
"1","
- poutcome      "
"1","  2"
"1","   760.64"
"1"," 804.64"
"1","
<none>          "
"1","   "
"1","   756.79"
"1"," 804.79"
"1","
- age           "
"1","  1"
"1","   759.93"
"1"," 805.93"
"1","
- cons.conf.idx "
"1","  1"
"1","   761.27"
"1"," 807.27"
"1","
- emp.var.rate  "
"1","  1"
"1","   761.46"
"1"," 807.46"
"1","
- campaign      "
"1","  1"
"1","   765.96"
"1"," 811.96"
"1","
- contact       "
"1","  1"
"1","   769.67"
"1"," 815.67"
"1","
- cons.price.idx"
"1","  1"
"1","   770.37"
"1"," 816.37"
"1","
"
"1","
Step:  AIC="
"1",""
"1","795.37"
"1",""
"1","
"
"1",""
"1","y_int ~ age + married_ind + default + housing + loan + contact + "
"1",""
"1","
    campaign + ppdays_ind + previous + poutcome + emp.var.rate + "
"1",""
"1","
    cons.price.idx + cons.conf.idx + euribor3m + nr.employed"
"1",""
"1","

"
"1","                "
"1"," Df"
"1"," Deviance"
"1","    AIC"
"1","
- nr.employed   "
"1","  1"
"1","   759.37"
"1"," 793.37"
"1","
- default       "
"1","  1"
"1","   759.38"
"1"," 793.38"
"1","
- ppdays_ind    "
"1","  1"
"1","   759.42"
"1"," 793.42"
"1","
- loan          "
"1","  1"
"1","   759.44"
"1"," 793.44"
"1","
- euribor3m     "
"1","  1"
"1","   759.53"
"1"," 793.53"
"1","
- housing       "
"1","  1"
"1","   760.33"
"1"," 794.33"
"1","
- married_ind   "
"1","  1"
"1","   760.36"
"1"," 794.36"
"1","
- previous      "
"1","  1"
"1","   760.92"
"1"," 794.92"
"1","
<none>          "
"1","   "
"1","   759.37"
"1"," 795.37"
"1","
- poutcome      "
"1","  2"
"1","   763.50"
"1"," 795.50"
"1","
- cons.conf.idx "
"1","  1"
"1","   764.13"
"1"," 798.13"
"1","
- emp.var.rate  "
"1","  1"
"1","   764.26"
"1"," 798.26"
"1","
- age           "
"1","  1"
"1","   764.43"
"1"," 798.43"
"1","
- campaign      "
"1","  1"
"1","   769.37"
"1"," 803.37"
"1","
- contact       "
"1","  1"
"1","   772.48"
"1"," 806.48"
"1","
- cons.price.idx"
"1","  1"
"1","   773.38"
"1"," 807.38"
"1","
"
"1","
Step:  AIC="
"1",""
"1","793.37"
"1",""
"1","
"
"1",""
"1","y_int ~ age + married_ind + default + housing + loan + contact + "
"1",""
"1","
    campaign + ppdays_ind + previous + poutcome + emp.var.rate + "
"1",""
"1","
    cons.price.idx + cons.conf.idx + euribor3m"
"1",""
"1","

"
"1","                "
"1"," Df"
"1"," Deviance"
"1","    AIC"
"1","
- default       "
"1","  1"
"1","   759.38"
"1"," 791.38"
"1","
- ppdays_ind    "
"1","  1"
"1","   759.42"
"1"," 791.42"
"1","
- loan          "
"1","  1"
"1","   759.44"
"1"," 791.44"
"1","
- euribor3m     "
"1","  1"
"1","   759.65"
"1"," 791.65"
"1","
- housing       "
"1","  1"
"1","   760.34"
"1"," 792.34"
"1","
- married_ind   "
"1","  1"
"1","   760.37"
"1"," 792.37"
"1","
- previous      "
"1","  1"
"1","   760.92"
"1"," 792.92"
"1","
<none>          "
"1","   "
"1","   759.37"
"1"," 793.37"
"1","
- poutcome      "
"1","  2"
"1","   763.51"
"1"," 793.51"
"1","
- emp.var.rate  "
"1","  1"
"1","   764.44"
"1"," 796.44"
"1","
- age           "
"1","  1"
"1","   764.44"
"1"," 796.44"
"1","
- cons.conf.idx "
"1","  1"
"1","   768.49"
"1"," 800.49"
"1","
- campaign      "
"1","  1"
"1","   769.46"
"1"," 801.46"
"1","
- contact       "
"1","  1"
"1","   772.79"
"1"," 804.79"
"1","
- cons.price.idx"
"1","  1"
"1","   788.61"
"1"," 820.61"
"1","
"
"1","
Step:  AIC="
"1",""
"1","791.38"
"1",""
"1","
"
"1",""
"1","y_int ~ age + married_ind + housing + loan + contact + campaign + "
"1",""
"1","
    ppdays_ind + previous + poutcome + emp.var.rate + cons.price.idx + "
"1",""
"1","
    cons.conf.idx + euribor3m"
"1",""
"1","

"
"1","                "
"1"," Df"
"1"," Deviance"
"1","    AIC"
"1","
- ppdays_ind    "
"1","  1"
"1","   759.43"
"1"," 789.43"
"1","
- loan          "
"1","  1"
"1","   759.46"
"1"," 789.46"
"1","
- euribor3m     "
"1","  1"
"1","   759.66"
"1"," 789.66"
"1","
- housing       "
"1","  1"
"1","   760.35"
"1"," 790.35"
"1","
- married_ind   "
"1","  1"
"1","   760.38"
"1"," 790.38"
"1","
- previous      "
"1","  1"
"1","   760.94"
"1"," 790.94"
"1","
<none>          "
"1","   "
"1","   759.38"
"1"," 791.38"
"1","
- poutcome      "
"1","  2"
"1","   763.56"
"1"," 791.56"
"1","
- emp.var.rate  "
"1","  1"
"1","   764.47"
"1"," 794.47"
"1","
- age           "
"1","  1"
"1","   764.47"
"1"," 794.47"
"1","
- cons.conf.idx "
"1","  1"
"1","   768.52"
"1"," 798.52"
"1","
- campaign      "
"1","  1"
"1","   769.47"
"1"," 799.47"
"1","
- contact       "
"1","  1"
"1","   773.03"
"1"," 803.03"
"1","
- cons.price.idx"
"1","  1"
"1","   788.63"
"1"," 818.63"
"1","
"
"1","
Step:  AIC="
"1",""
"1","789.43"
"1",""
"1","
"
"1",""
"1","y_int ~ age + married_ind + housing + loan + contact + campaign + "
"1",""
"1","
    previous + poutcome + emp.var.rate + cons.price.idx + cons.conf.idx + "
"1",""
"1","
    euribor3m"
"1",""
"1","

"
"1","                "
"1"," Df"
"1"," Deviance"
"1","    AIC"
"1","
- loan          "
"1","  1"
"1","   759.51"
"1"," 787.51"
"1","
- euribor3m     "
"1","  1"
"1","   759.70"
"1"," 787.70"
"1","
- housing       "
"1","  1"
"1","   760.41"
"1"," 788.41"
"1","
- married_ind   "
"1","  1"
"1","   760.44"
"1"," 788.44"
"1","
<none>          "
"1","   "
"1","   759.43"
"1"," 789.43"
"1","
- previous      "
"1","  1"
"1","   761.97"
"1"," 789.97"
"1","
- age           "
"1","  1"
"1","   764.50"
"1"," 792.50"
"1","
- emp.var.rate  "
"1","  1"
"1","   764.59"
"1"," 792.59"
"1","
- poutcome      "
"1","  2"
"1","   769.56"
"1"," 795.56"
"1","
- cons.conf.idx "
"1","  1"
"1","   768.54"
"1"," 796.54"
"1","
- campaign      "
"1","  1"
"1","   769.49"
"1"," 797.49"
"1","
- contact       "
"1","  1"
"1","   773.11"
"1"," 801.11"
"1","
- cons.price.idx"
"1","  1"
"1","   788.71"
"1"," 816.71"
"1","
"
"1","
Step:  AIC="
"1",""
"1","787.51"
"1",""
"1","
"
"1",""
"1","y_int ~ age + married_ind + housing + contact + campaign + previous + "
"1",""
"1","
    poutcome + emp.var.rate + cons.price.idx + cons.conf.idx + "
"1",""
"1","
    euribor3m"
"1",""
"1","

"
"1","                "
"1"," Df"
"1"," Deviance"
"1","    AIC"
"1","
- euribor3m     "
"1","  1"
"1","   759.77"
"1"," 785.77"
"1","
- housing       "
"1","  2"
"1","   762.19"
"1"," 786.19"
"1","
- married_ind   "
"1","  1"
"1","   760.51"
"1"," 786.51"
"1","
<none>          "
"1","   "
"1","   759.51"
"1"," 787.51"
"1","
- previous      "
"1","  1"
"1","   762.09"
"1"," 788.09"
"1","
- age           "
"1","  1"
"1","   764.55"
"1"," 790.55"
"1","
- emp.var.rate  "
"1","  1"
"1","   764.69"
"1"," 790.69"
"1","
- poutcome      "
"1","  2"
"1","   769.68"
"1"," 793.68"
"1","
- cons.conf.idx "
"1","  1"
"1","   768.66"
"1"," 794.66"
"1","
- campaign      "
"1","  1"
"1","   769.65"
"1"," 795.65"
"1","
- contact       "
"1","  1"
"1","   773.19"
"1"," 799.19"
"1","
- cons.price.idx"
"1","  1"
"1","   788.84"
"1"," 814.84"
"1","
"
"1","
Step:  AIC="
"1",""
"1","785.77"
"1",""
"1","
"
"1",""
"1","y_int ~ age + married_ind + housing + contact + campaign + previous + "
"1",""
"1","
    poutcome + emp.var.rate + cons.price.idx + cons.conf.idx"
"1",""
"1","

"
"1","                "
"1"," Df"
"1"," Deviance"
"1","    AIC"
"1","
- housing       "
"1","  2"
"1","   762.41"
"1"," 784.41"
"1","
- married_ind   "
"1","  1"
"1","   760.78"
"1"," 784.78"
"1","
<none>          "
"1","   "
"1","   759.77"
"1"," 785.77"
"1","
- previous      "
"1","  1"
"1","   762.40"
"1"," 786.40"
"1","
- age           "
"1","  1"
"1","   764.91"
"1"," 788.91"
"1","
- poutcome      "
"1","  2"
"1","   770.18"
"1"," 792.18"
"1","
- cons.conf.idx "
"1","  1"
"1","   768.97"
"1"," 792.97"
"1","
- campaign      "
"1","  1"
"1","   769.87"
"1"," 793.87"
"1","
- contact       "
"1","  1"
"1","   775.42"
"1"," 799.42"
"1","
- cons.price.idx"
"1","  1"
"1","   804.36"
"1"," 828.36"
"1","
- emp.var.rate  "
"1","  1"
"1","   851.94"
"1"," 875.94"
"1","
"
"1","
Step:  AIC="
"1",""
"1","784.41"
"1",""
"1","
"
"1",""
"1","y_int ~ age + married_ind + contact + campaign + previous + poutcome + "
"1",""
"1","
    emp.var.rate + cons.price.idx + cons.conf.idx"
"1",""
"1","

"
"1","                "
"1"," Df"
"1"," Deviance"
"1","    AIC"
"1","
- married_ind   "
"1","  1"
"1","   763.35"
"1"," 783.35"
"1","
<none>          "
"1","   "
"1","   762.41"
"1"," 784.41"
"1","
- previous      "
"1","  1"
"1","   764.70"
"1"," 784.70"
"1","
- age           "
"1","  1"
"1","   767.53"
"1"," 787.53"
"1","
- poutcome      "
"1","  2"
"1","   772.76"
"1"," 790.76"
"1","
- cons.conf.idx "
"1","  1"
"1","   771.92"
"1"," 791.92"
"1","
- campaign      "
"1","  1"
"1","   772.35"
"1"," 792.35"
"1","
- contact       "
"1","  1"
"1","   777.57"
"1"," 797.57"
"1","
- cons.price.idx"
"1","  1"
"1","   808.00"
"1"," 828.00"
"1","
- emp.var.rate  "
"1","  1"
"1","   855.85"
"1"," 875.85"
"1","
"
"1","
Step:  AIC="
"1",""
"1","783.35"
"1",""
"1","
"
"1",""
"1","y_int ~ age + contact + campaign + previous + poutcome + emp.var.rate + "
"1",""
"1","
    cons.price.idx + cons.conf.idx"
"1",""
"1","

"
"1","                "
"1"," Df"
"1"," Deviance"
"1","    AIC"
"1","
<none>          "
"1","   "
"1","   763.35"
"1"," 783.35"
"1","
- previous      "
"1","  1"
"1","   765.77"
"1"," 783.77"
"1","
- age           "
"1","  1"
"1","   767.61"
"1"," 785.61"
"1","
- poutcome      "
"1","  2"
"1","   774.11"
"1"," 790.11"
"1","
- cons.conf.idx "
"1","  1"
"1","   772.90"
"1"," 790.90"
"1","
- campaign      "
"1","  1"
"1","   773.19"
"1"," 791.19"
"1","
- contact       "
"1","  1"
"1","   778.73"
"1"," 796.73"
"1","
- cons.price.idx"
"1","  1"
"1","   809.37"
"1"," 827.37"
"1","
- emp.var.rate  "
"1","  1"
"1","   859.65"
"1"," 877.65"
"1","
"
"0","summary(glm_step)"
"1","
Call:
"
"1",""
"1","glm(formula = y_int ~ age + contact + campaign + previous + poutcome + 
    emp.var.rate + cons.price.idx + cons.conf.idx, family = binomial, 
    data = df_train)"
"1",""
"1","
"
"1","
Coefficients:
"
"1","                   "
"1","   Estimate"
"1"," Std. Error"
"1"," z value"
"1"," Pr(>|z|)"
"1","    "
"1","
(Intercept)        "
"1"," -1.687e+02"
"1","  2.861e+01"
"1","  -5.896"
"1"," 3.72e-09"
"1"," ***"
"1","
age                "
"1","  1.703e-02"
"1","  8.322e-03"
"1","   2.047"
"1"," 0.040669"
"1"," *  "
"1","
contacttelephone   "
"1"," -9.801e-01"
"1","  2.562e-01"
"1","  -3.825"
"1"," 0.000131"
"1"," ***"
"1","
campaign           "
"1"," -1.317e-01"
"1","  4.858e-02"
"1","  -2.711"
"1"," 0.006702"
"1"," ** "
"1","
previous           "
"1","  6.681e-01"
"1","  4.938e-01"
"1","   1.353"
"1"," 0.176123"
"1","    "
"1","
poutcomenonexistent"
"1","  1.307e+00"
"1","  6.334e-01"
"1","   2.064"
"1"," 0.039024"
"1"," *  "
"1","
poutcomesuccess    "
"1","  1.304e+00"
"1","  5.235e-01"
"1","   2.492"
"1"," 0.012719"
"1"," *  "
"1","
emp.var.rate       "
"1"," -8.974e-01"
"1","  1.069e-01"
"1","  -8.395"
"1","  < 2e-16"
"1"," ***"
"1","
cons.price.idx     "
"1","  1.812e+00"
"1","  3.092e-01"
"1","   5.859"
"1"," 4.65e-09"
"1"," ***"
"1","
cons.conf.idx      "
"1","  5.959e-02"
"1","  1.981e-02"
"1","   3.009"
"1"," 0.002623"
"1"," ** "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
(Dispersion parameter for "
"1",""
"1","binomial"
"1",""
"1"," family taken to be "
"1",""
"1","1"
"1",""
"1",")

"
"1",""
"1","    Null deviance: 999.48  on 720  degrees of freedom
"
"1",""
"1","Residual deviance: 763.35  on 711  degrees of freedom
"
"1","AIC: "
"1",""
"1","783.35"
"1",""
"1","

"
"1",""
"1","Number of Fisher Scoring iterations: "
"1",""
"1","6"
"1",""
"1","
"
"1","
"
"0","glmf <- glm(formula = y_int ~ age + contact + campaign + previous + poutcome + "
"0","    emp.var.rate + cons.price.idx + cons.conf.idx, family = binomial, "
"0","    data = df_train)"
"0","summary(glmf)"
"1","
Call:
"
"1",""
"1","glm(formula = y_int ~ age + contact + campaign + previous + poutcome + 
    emp.var.rate + cons.price.idx + cons.conf.idx, family = binomial, 
    data = df_train)"
"1",""
"1","
"
"1","
Coefficients:
"
"1","                   "
"1","   Estimate"
"1"," Std. Error"
"1"," z value"
"1"," Pr(>|z|)"
"1","    "
"1","
(Intercept)        "
"1"," -1.687e+02"
"1","  2.861e+01"
"1","  -5.896"
"1"," 3.72e-09"
"1"," ***"
"1","
age                "
"1","  1.703e-02"
"1","  8.322e-03"
"1","   2.047"
"1"," 0.040669"
"1"," *  "
"1","
contacttelephone   "
"1"," -9.801e-01"
"1","  2.562e-01"
"1","  -3.825"
"1"," 0.000131"
"1"," ***"
"1","
campaign           "
"1"," -1.317e-01"
"1","  4.858e-02"
"1","  -2.711"
"1"," 0.006702"
"1"," ** "
"1","
previous           "
"1","  6.681e-01"
"1","  4.938e-01"
"1","   1.353"
"1"," 0.176123"
"1","    "
"1","
poutcomenonexistent"
"1","  1.307e+00"
"1","  6.334e-01"
"1","   2.064"
"1"," 0.039024"
"1"," *  "
"1","
poutcomesuccess    "
"1","  1.304e+00"
"1","  5.235e-01"
"1","   2.492"
"1"," 0.012719"
"1"," *  "
"1","
emp.var.rate       "
"1"," -8.974e-01"
"1","  1.069e-01"
"1","  -8.395"
"1","  < 2e-16"
"1"," ***"
"1","
cons.price.idx     "
"1","  1.812e+00"
"1","  3.092e-01"
"1","   5.859"
"1"," 4.65e-09"
"1"," ***"
"1","
cons.conf.idx      "
"1","  5.959e-02"
"1","  1.981e-02"
"1","   3.009"
"1"," 0.002623"
"1"," ** "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
(Dispersion parameter for "
"1",""
"1","binomial"
"1",""
"1"," family taken to be "
"1",""
"1","1"
"1",""
"1",")

"
"1",""
"1","    Null deviance: 999.48  on 720  degrees of freedom
"
"1",""
"1","Residual deviance: 763.35  on 711  degrees of freedom
"
"1","AIC: "
"1",""
"1","783.35"
"1",""
"1","

"
"1",""
"1","Number of Fisher Scoring iterations: "
"1",""
"1","6"
"1",""
"1","
"
"1","
"
"0","vif(glmf) # no colinearity detected"
"1","              "
"1","     GVIF"
"1"," Df"
"1"," GVIF^(1/(2*Df))"
"1","
age           "
"1"," 1.014357"
"1","  1"
"1","        1.007153"
"1","
contact       "
"1"," 1.771802"
"1","  1"
"1","        1.331091"
"1","
campaign      "
"1"," 1.033617"
"1","  1"
"1","        1.016670"
"1","
previous      "
"1"," 6.938581"
"1","  1"
"1","        2.634119"
"1","
poutcome      "
"1"," 7.365565"
"1","  2"
"1","        1.647409"
"1","
emp.var.rate  "
"1"," 4.093046"
"1","  1"
"1","        2.023128"
"1","
cons.price.idx"
"1"," 4.577590"
"1","  1"
"1","        2.139530"
"1","
cons.conf.idx "
"1"," 1.265384"
"1","  1"
"1","        1.124893"
"1","
"
"0","# Predict the probability on TEST - cutoff 0.5"
"0","df_test$PredProb <- predict.glm(glmf, newdata = df_test, type = 'response')"
"0",""
"0","#create Prediction Indicators for y"
"0","df_test$Pred_Y <- ifelse(df_test$PredProb >= 0.5, 1, 0)"
"0",""
"0","caret::confusionMatrix(as.factor(df_test$y_int),as.factor(df_test$Pred_Y), positive = '1') #this function and package auto computes a lot of the metrics"
"1","Confusion Matrix and Statistics

"
"1","          Reference
"
"1","Prediction"
"1","  0"
"1","  1"
"1","
         0"
"1"," 73"
"1"," 15"
"1","
         1"
"1"," 32"
"1"," 61"
"1","
"
"1",""
"1","                         "
"1","                 "
"1","
"
"1","               Accuracy :"
"1"," 0.7403          "
"1","
"
"1","                 95% CI :"
"1"," (0.6701, 0.8025)"
"1","
"
"1","    No Information Rate :"
"1"," 0.5801          "
"1","
"
"1","    P-Value [Acc > NIR] :"
"1"," 5.267e-06       "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1","                  Kappa :"
"1"," 0.483           "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1"," Mcnemar's Test P-Value :"
"1"," 0.0196          "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1","            Sensitivity :"
"1"," 0.8026          "
"1","
"
"1","            Specificity :"
"1"," 0.6952          "
"1","
"
"1","         Pos Pred Value :"
"1"," 0.6559          "
"1","
"
"1","         Neg Pred Value :"
"1"," 0.8295          "
"1","
"
"1","             Prevalence :"
"1"," 0.4199          "
"1","
"
"1","         Detection Rate :"
"1"," 0.3370          "
"1","
"
"1","   Detection Prevalence :"
"1"," 0.5138          "
"1","
"
"1","      Balanced Accuracy :"
"1"," 0.7489          "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1","       'Positive' Class :"
"1"," 1               "
"1","
"
"1","                         "
"1","                 "
"1","
"
"0","# accuracy: 74%"
"0","# sens: 80%"
"0","# Spec: 70%"
"0",""
"0","plot(glmf)"
